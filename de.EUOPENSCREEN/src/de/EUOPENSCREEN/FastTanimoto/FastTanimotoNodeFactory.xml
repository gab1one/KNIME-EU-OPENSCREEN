<?xml version="1.0" encoding="UTF-8"?>
<knimeNode icon="./FastTanimotoIcon.png" type="Manipulator" xmlns="http://knime.org/node/v2.8" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://knime.org/node/v2.10 http://knime.org/node/v2.10.xsd">
    <name>Fast Tanimoto</name>
    
    <shortDescription>
        Compares molecule fingerprints within a single data set and lists molecule identifiers having tanimoto scores larger than a preset threshold
    </shortDescription>
    
    <fullDescription>
        <intro>Compares molecule fingerprints and lists identifiers of molecules having scores larger than a preset threshold. The node is optimized for processing of larger sets of molecules (tested with 50'000 molecules, processing time is less than 5 minutes on a Core i5 with 3 Ghz). Prevents comparison of a molecule to itself</intro>
        
        <option name="Molecule Identifier">String identifier of the molecule</option>
        <option name="Molecule Fingerprints">Fingerprint BitVector column as generated by the CDK/Fingerprint or RDKit/Fingerprint nodes</option>
        <option name="Tanimoto Threshold">Fraction of identical bits in both molecule fingerprints, range 0-1. Only molecules with a score above the threshold will be listed in the output columns</option>
    
    </fullDescription>
    
    <ports>
        <inPort index="0" name="Molecules">Table with string columns for molecule identifier and a BitVector fingerprint column</inPort>
        <!-- possibly more input ports here-->
        <outPort index="0" name="Molecules with similarities">Input table with attached tanimoto.id (a copy of the string identifiers of the molecule compared), tanimoto.similars (list of identifiers of molecules with a tanimoto similarity higher than the threshold), tanimoto.coefficients (the corresponding tanimito similarities of those molecules), tanimoto.num.similars (the number of similar molecules found)</outPort>
        <!-- possibly more output ports here-->
    </ports>    
   
</knimeNode>
